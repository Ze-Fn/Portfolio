// Checking for dupl rows in SQL
1. Return the whole table first.
2. Create at a CTE that adds row_num 

WITH dupl AS
(
SELECT 
	*,
	ROW_NUMBER() OVER(
		PARTITION BY 
			company,
			location,
			industry,
			total_laid_off,
			percentage_laid_off,
			`date`,
			stage,
			country,
			funds_raised_millions
		) AS row_num
		FROM layoffs_staging
)
SELECT *
FROM dupl
WHERE row_num > 1;

3. Check individual dupl in the layoffs_staging
4. Create a new table (staging) to store the results from CTE into a dedicated table. Copy to Clipboard -> Create Statement.

CREATE TABLE layoffs_staging2 (
	`company` text,
	`location` text,
	`industry` text,
	`total_laid_off` int DEFAULT NULL,
	`percentage_laid_off` text,
	`date` text,
	`stage` text,
	`country` text,
	`funds_raised_millions` int DEFAULT NULL,
	`row_num` INT 	//This is the new row_num that indicates dupl if the value > 1
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

5. Delete the dupl from layoffs_staging2.

DELETE 
FROM layoffs_staging2
WHERE row_num > 1;

// Standardizing the data
1. Check each column for irregular name convention using DISTINCT.
2. For each distinct naming convention in the same category, UPDATE the distinct names into unform naming.

UPDATE layoffs_staging2
SET industry = 'Crypto'
WHERE industry LIKE 'Crypto%';


